---
title: Designing a Domain Model
description: Using Domain Driven Development and UML to design a more complex domain model.
keywords: Object Oriented Design, UML, Domain Driven Design, domain model, Entity Framework
---
# Designing a Domain Model

**CS296N Web Development 2**

| Weekly topics                              |                                 |
| ------------------------------------------ | ------------------------------- |
| 1. Intro to course and Input validation    | 6. Async/Await                  |
| 2. Repositories and Unit Testing           | 7. Performance and Load Testing |
| 3. Publishing to Azure / Intro to Identity | **8. Complex Domain Models**    |
| 4. Authentication                          | 9. Docker containers            |
| 5. Authorization                           | 10. Term project                |

## Contents

[TOC]

## Review

### OOP Design and Domain Models

In the System Design class, we covered [the basics of Object Oriented design](https://profbird.github.io/CS246-CourseMaterials/LectureNotes/CS246LN-W04-D1-OopDesignReview+UML.html) and how to model the relationships between classes in a UML class diagram like the [Tip of the Day domain model.](https://profbird.github.io/CS246-CourseMaterials/LectureNotes/Images/TipOfTheDayDomainModel2022.pdf)

### Entity Framework

We learned how to create a DbContext class containing DbSets that are based on our domain models.

------



## Designing Domain Models for ASP.NET Core MVC

### What is a domain model?

- What is the meaning of "[domain](https://www.wolframalpha.com/input/?i=domain)" in general, in math?
- What is meant by the problem "domain" in software development?

### How do we Apply Domain Driven Design?

[Domain Driven Design](https://martinfowler.com/bliki/DomainDrivenDesign.html)

- Use the terminology of the domain (ubiquitous language) for our classes, fields, etc..
- Keep our focus narrow&mdash;on the problem we are solving. Don't make it too general or abstract.
- Identify aggregates and root entities.
- Separate the domain model from other classes responsible for persistence.

### What constraints are imposed by Entity Framework?

- Which OOP relationships are allowed and/or useful?
- Are there work-arounds for relationships that aren't allowed?
- What is a circular relationship? Are those OK?
- Do all domain model classes need to be related? If not, how do we decide?
- How will users be modeled if we are using Identity?



### Example: Book Reviews Domain Model

#### Description of the problem domain

This web site lets users enter book reviews, which include information on the book: title, publication date, author, and the author's birth date. Once a book has been reviewed by one user, it can be reviewed by other users as well. Users my also make comments on reviews.

#### UML diagram

[Domain model UML class diagram](Images/BookReviewsComplexDomainModel.pdf)

#### C# code

Code based on the UML class diagram:

```c#
public class AppUser : IdentityUser
{
  public string Name { get; set; }  // Real name
}

public class Book
{
  private List<Author> authors = new List<Author>();
  private List<Review> reviews = new List<Review>();

  public int BookID { get; set; }
  public List<Author> Authors { get { return authors; } }
  public List<Review> Reviews { get { return reviews; } }
  public string Title { get; set; }
  public DateTime PubDate { get; set; }
}

public class Author
{
  public int AuthorID { get; set; }
  public string Name { get; set; }
  public DateTime Birthday { get; set; }
}

public class Review
{
  private List<Comment> comments = new List<Comment>();
  
  public List<Comment> Comments { get { return comments; } }
  public int ReviewID { get; set; }
  public string ReviewText { get; set; }
  public AppUser Reviewer { get; set; }
}

public class Comment
    {
        public int CommentID { get; set; }
        public string CommentText { get; set; }
        public AppUser UserName { get; set; }
        public Review UserReview { get; set; }
    }
```

#### Questions

- How is aggregation being implemented?
- How is composition being implemented?
- What is it in the UML class diagram that got translated into lists?
- Why are the lists read only (only a `get` on the property)
- Why are there both public `List` properties and private `List` fields?
- Will EF generate any tables with one-to-many relationships? Many-to-many relationships?
- Will EF generate any junction tables?
- Do we need a many-to-many relationship to manage books that have multiple authors and authors that have written multiple books?

#### The database

Look at the database generated by EF.



### Exercise: Modify the BookReview web site

We won't use the full-blown model shown above. We'll just (add a comment model? Add a Book model?)



## ~~Answers~~

### ~~Work-around for implementing many-to-many relationships~~

~~Use an [*association class*](https://www.ibm.com/support/knowledgecenter/SSCLKU_7.5.5/com.ibm.xtools.modeler.doc/topics/cassnclss.html). This will be translated to a *junction table* in the database.~~

------

 [![Creative Commons License](https://i.creativecommons.org/l/by/4.0/88x31.png)](http://creativecommons.org/licenses/by/4.0/)System Design  Lecture Notes by [Brian Bird](https://profbird.dev), 2018 (Revised winter <time>2022</time>), are licensed under a [Creative Commons Attribution 4.0 International License](http://creativecommons.org/licenses/by/4.0/). 

------